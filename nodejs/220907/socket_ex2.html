<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    
    <style>

        .chat-list { 
            background-color: lightgrey; width:50%; 
            height: 50%;
            padding:10px; 
            border-radius: 20px;
            }

        .chat-list div div{
            display: inline-block;
            padding: 3px;
        }

        .mine {
            text-align:right;
            /* float: right; */

            /* float를 쓰면 배치 자체가 오른쪽으로 가는 것! float개념에 대해서 좀 더 보충하기!!!!!!! */
        }
        .mine div {
            background-color: yellow;
        }

        .yours div {
            background-color: white;
        }

    </style>
</head>
<body>
    <!-- 메세지를 보내거나 받으면 보이는 곳 -->
    <div id="chat-list" class="chat-list"></div><br>
    <input type="text" id="message">
    <button type="button" onclick="send();">전송</button>
    

    <script>
        var id = ""; //서버로 받은 id를 저장
        var socket = io.connect();
        socket.on('info',function(data) { id = data; });
        
        //모든사람한테 지금 접속한 새로운 사람을 알려주는것.
        function send() {
            console.log(id);
            let msg = document.getElementById('message').value;
            socket.emit('send',{id: id, msg: msg});
            //키값과 변수명이 동일하면 socket.emit('send',{id,msg}); 이렇게 쓸수 있음.
            document.getElementById('message').value = "";

        }
        socket.on('newMessage',function(data){
            //data = {id: ~~, msg:~~}
            let chat_list =document.getElementById('chat-list');
            let div = document.createElement('div');
            let div_chat = document.createElement('div');

            div_chat.textContent = data.msg;

            //아이디. 즉, 닉네임 없을경우
            // if (msg == document.getElementById('message').value) {div.classList.add('mine');}
            // else {div.classList.add('yours');}
            
            //아이디가 있을경우 이렇게 사용
            if (data.id == id) {div.classList.add('mine');}
            else {div.classList.add('yours');}
            div.appendChild(div_chat);
            chat_list.appendChild(div);
        });

    
        socket.on('notice',function(data){
            let chat_list = document.getElementById('chat-list');
            let div = document.createElement('div');
            div.textContent = data;

            chat_list.appendChild(div);
        });
        
    </script>
</body>
</html>